#  Isaac Sim Unitree Go2 ROS2
[![Python](https://img.shields.io/badge/python-3.11-blue.svg)](https://docs.python.org/3/whatsnew/3.11.html)
[![ROS2](https://img.shields.io/badge/ROS2-Humble-orange.svg)](https://docs.ros.org/en/humble/index.html)
[![IsaacSim](https://img.shields.io/badge/IsaacSim-5.1.0-red.svg)](https://docs.omniverse.nvidia.com/isaacsim/latest/overview.html)
[![IsaacLab](https://img.shields.io/badge/IsaacLab-2.3.0-purple.svg)](https://isaac-sim.github.io/IsaacLab/main/)
[![Linux platform](https://img.shields.io/badge/platform-Ubuntu--22.04-green.svg)](https://releases.ubuntu.com/22.04/)

This fork supports Isaac Sim 5.1 and Isaac Lab 2.3+.

Welcome to the Isaac Sim Unitree Go2 repository! This repository provides a Unitree Go2 quadruped robot simulation, leveraging the Isaac Sim/Isaac Lab framework and integrating seamlessly with a ROS 2 interface. It offers a flexible platform for testing navigation, decision-making, and other autonomous tasks in various scenarios.


<table>
  <tr>
    <td><img src="media/sim-demo1.gif" style="width: 100%;"></td>
    <td><img src="media/sim-demo2.gif" style="width: 100%;"></td>
  </tr>
</table>


## Installation Guide
**Step 0:** Install [Isaac Sim 5.1](https://docs.isaacsim.omniverse.nvidia.com/latest/installation/download.html) (pip or binary install).

**Step I:** Please follow the [Isaac Lab official documentation](https://isaac-sim.github.io/IsaacLab/main/source/setup/installation/index.html) to install Isaac Lab 2.3.0 (or newer).

**Step II:** Please install [ROS2 Humble](https://docs.ros.org/en/humble/index.html) if you want to run tools like `rviz2`/`nav2` on the same machine.  
If your Isaac Sim / Isaac Lab Python env cannot import `rclpy` (common for pip installs on Windows/Python 3.11), the simulator autoâ€‘loads the **bundled ROS2 Humble** that ships with Isaac Sim.

**Step III:** Install the prerequisite C extension in the conda environment. [reference link](https://stackoverflow.com/questions/58424974/anaconda-importerror-usr-lib64-libstdc-so-6-version-glibcxx-3-4-21-not-fo)
```
# default conda env for Isaac Lab
conda activate env_isaaclab      
```

**Step IV:** Clone this repo to your local directory.
```
git clone https://github.com/Zhefan-Xu/isaac-go2-ros2.git
```

## Run Unitree Go2 Simulation 
To run the simulation, please use the following command:
```
conda activate isaaclab
python isaac_go2_ros2.py
```
Once the simulation is loaded, the robot can be teleoperated by the keyboard:

```W```: Forward, ```A```: Left, ```S```: Backward, ```D```: Right, ```Z```: Left Turn, ```C```: Right Turn.


https://github.com/user-attachments/assets/7abb41fd-26f7-4e5d-bc7f-98ee10467a6a


## ROS2 Topics and Visualization
After launching the simulation, the ROS2 data can be visualized in ```Rviz2```:
```
rviz2 -d /path/to/isaac-go2-ros2/rviz/go2.rviz
```
![rviz](https://github.com/user-attachments/assets/946b6a31-b52a-4153-b337-846087fc2b7d)

Here is a categorized list of ROS 2 topics available for the Unitree Go2:

**Command and Control**  
- `/unitree_go2/cmd_vel`:  Topic to send velocity commands to the robot for motion control.
  - If you use Nav2 or teleop with small speeds, you can scale incoming commands via `GO2_CMDVEL_SCALE` (default `1.0`).
    Example: `GO2_CMDVEL_SCALE=2.0 python isaac_go2_ros2.py`.

**Front Camera**  
- `/unitree_go2/front_cam/color_image`: Publishes RGB color images captured by the front camera.
- `/unitree_go2/front_cam/depth_image`: Publishes depth images from the front camera.
- `unitree_go2/front_cam/semantic_segmentation_image`: Publishes semantic segmentation images from the front camera.
- `/unitree_go2/front_cam/info`: Publishes camera information, including intrinsic parameters.

**LIDAR**  
- `/unitree_go2/lidar/point_cloud`:  Publishes a point cloud generated by the robot's LIDAR sensor.

**Odometry and Localization**  
- `/unitree_go2/odom`:  Publishes odometry data, including the robot's position, orientation, and velocity.
- `/unitree_go2/pose`:  Publishes the current pose of the robot in the world frame.


## Simulation Environments & settings
The simulation environments and settings can be changed in ```isaac-go2-ros2/cfg/sim.yaml``` config file. 

#### Launch different simulation environments
The current implementation contains a few environments which can be found on ```isaac-go2-ros2/env/sim_env.py```, which follows standard Isaac Sim method for importing USD environments. To change the environment, please change the ```env_name``` in the config file ```isaac-go2-ros2/cfg/sim.yaml```. Current available environments:
- ```warehouse```: A simple warehouse environment in Isaac Sim.
- ```warehouse-forklifts```: A warehouse environment with forklifts.
- ```warehouse-shelves```: A warehouse environment with shelves.
- ```full-warehouse```: A full warehouse environment containing everything.
- ```obstacle-sparse```: A sparse obstacle field environment.
- ```obstacle-medium```: A  medium obstacle field environment.
- ```obstacle-dense```: A dense obstacle field environment.


#### Launch multiple robots in the environment
This repository supports running multiple Unitree Go2 robots and the number of robots can by changed by the ```num_envs``` parameter in the config file ```isaac-go2-ros2/cfg/sim.yaml```. The following shows an example video.

https://github.com/user-attachments/assets/47ef05c1-5124-4feb-afc8-a3f2c306a212




## Example Usage
The video shows an example of using this repo with an [RL agent](https://github.com/Zhefan-Xu/NavRL) to achieve navigation and collision avoidance:


https://github.com/user-attachments/assets/ccc986c6-bf94-41fe-a4d5-3417ce8b3384

## Acknowledgement
The Go2 controller is based on the RL controller implemented in [go2_omniverse](https://github.com/abizovnuralem/go2_omniverse).


